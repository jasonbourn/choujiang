<!DOCTYPE html>
<html lang="en">
<head>
    <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <style>
        Body{background-image:url(a.jpg) ;background-attachment:fixed;background-repeat:no-repeat;background-size:cover;-moz-background-size:cover;-webkit-background-size:cover;}
        #con{
            position: absolute;
            top: 50%;
            -webkit-transform: translateY(-50%);
            -moz-transform:  translateY(-50%);
            -ms-transform:  translateY(-50%);
            -o-transform:  translateY(-50%);
            transform:  translateY(-50%);
        }
        #name {
            color: transparent;
            -webkit-text-stroke: 2px #ff1809;
        }
    </style>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8">
    <title>春闱科技年会抽奖</title>
</head>
<body>
<canvas id="canvas">Canvas is not supported in your browser.</canvas>
 <section >
     <div  class="container col-sm-12" id="con">
         <div class="row">
             <div class="pull-right" ><button class="btn btn-sm btn-danger" id="showList">中奖名单</button></div>
         </div>
         <div class="row">
             <div  style="height: 100px;font-size:3.5em;text-align: center;color:rgba(0, 0, 0, 0.95); filter: glow(color=#ffff00, strength=00)" >大奖会是你的吗？</div>
         </div>
         <div class="row">
             <div class="col-sm-offset-3" >
                 <div class="col-sm-8 alert alert-danger text-center" style="height: 150px;font-size:3.5em;text-align: center;color:#fe9794; filter: glow(color=#ffff00, strength=00)" id="name"></div>
             </div>
             <div class="col-sm-1" ></div>
         </div>
         <div class="row">
                 <div class="col-sm-offset-3" >
                     <div class="col-sm-2">
                         <button class="btn btn-lg btn-primary" id="btntdj" >特等奖</button>
                     </div>
                     <div class="col-sm-2" >
                         <button class="btn btn-lg btn-primary" id="btnydj" >一等奖</button>
                     </div>
                     <div class="col-sm-2" >
                         <button class="btn btn-lg btn-primary" id="btnedj" >二等奖</button>
                     </div>
                     <div class="col-sm-2" >
                         <button class="btn btn-lg btn-primary" id="btnsdj" >三等奖</button>
                     </div>
                 </div>

         </div>
         <footer >
             <blockquote>
                 <h4>注意：</h4>
                 <p>本程序公平公正，欢迎查阅监督。抽奖过程不要刷新页面，以免数据丢失</p>
             </blockquote>
         </footer>
     </div>
 </section>
 <div id="modal" class="modal fade bs-example-modal-lg">
     <div class="modal-dialog">
         <div class="modal-content">
             <div class="modal-header">
                 <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                 <h4 class="modal-title">中奖名单</h4>
             </div>
             <div class="modal-body">
                 <div class="row">
                     <div class="alert alert-danger">特等奖</div>
                     </div>
                 <div class="row">
                     <div id="divtdj"></div>
                 </div>
                 <div class="row">
                     <div class="alert alert-warning">一等奖</div>
                 </div>
                 <div class="row">
                     <div id="divydj"></div>
                 </div>
                 <div class="row">
                     <div class="alert alert-info">二等奖</div>
                 </div>
                 <div class="row">
                     <div id="divedj"></div>
                 </div>
                 <div class="row">
                     <div class="alert alert-success">三等奖</div>
                 </div>
                 <div class="row">
                     <div id="divsdj"></div>
                 </div>
                 </div>
             <div class="modal-footer">
                 <button type="button" class="btn btn-default" id="clearLocal">清空</button>
                 <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
             </div>
         </div><!-- /.modal-content -->
     </div><!-- /.modal-dialog -->
 </div>

 <audio id="audio" controls="controls" style="display: none">
     <source src="bjy.mp3" type="audio/mpeg">
     Your browser does not support the audio tag.
 </audio>
</body>
<script type="text/javascript" src="js/jQuery-2.1.4.min.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="layer/layer.js"></script>
<script type="text/javascript" src="js/canvas.js"></script>
<script type="text/javascript">
    $(function () {
        var mp3 =$("#audio")[0];
        var xinm = new Array();
        xinm[0] = "李明文13311290296总裁办";
        xinm[1] = "金涛13910168026总裁办";
        xinm[2] = "程建军18601126619总裁办";
        xinm[3] = "郭海滨13701187599总裁办";
        xinm[4] = "高磊13220101989总裁办";
        xinm[5] = "楚晓华18500299299总裁办";
        xinm[6] = "林小军18123288035总裁办";
        xinm[7] = "谢兆林13518196888总裁办";
        xinm[8] = "冉亮13681126734总裁办";
        xinm[9] = "梁景青15611850493财务部";
        xinm[10] = "何彤13701282673财务部";
        xinm[11] = "张京虹13671223921财务部";
        xinm[12] = "阮兆晨13699290327财务部";
        xinm[13] = "郑敏15810721236财务部";
        xinm[14] = "赵迪娜13910693260人力资源行政部";
        xinm[15] = "王婷15011588086人力资源行政部";
        xinm[16] = "张二苗13691514053人力资源行政部";
        xinm[17] = "彭晓燕13466573709人力资源行政部";
        xinm[18] = "康  蕾15901280700人力资源行政部";
        xinm[19] = "马珺13501192371医政部";
        xinm[20] = "梁巍然15521186810医政部";
        xinm[21] = "许旸13911770989市场部";
        xinm[22] = "王安好15810721810市场部";
        xinm[23] = "邱钦梅17710307992市场部";
        xinm[24] = "温銮13536679042市场部";
        xinm[25] = "王欢15378664933市场部";
        xinm[26] = "王子豪18600005672运营部";
        xinm[27] = "徐敏17710637758运营部";
        xinm[28] = "李文宇18601296524运营部";
        xinm[29] = "何音璇18310138069运营部";
        xinm[30] = "马立改18801496199运营部";
        xinm[31] = "伍廷超18910659337运营部";
        xinm[32] = "吕峰15801673933运营部";
        xinm[33] = "李瑛18911773480运营部";
        xinm[34] = "吕鑫18618425486硬件部";
        xinm[35] = "程俊18310121700硬件部";
        xinm[36] = "赵晓林18612138362硬件部";
        xinm[37] = "刘明龙18612138362硬件部";
        xinm[38] = "耿彩霞18600661665硬件部";
        xinm[39] = "刘飞13240250271硬件部";
        xinm[40] = "徐宁15832573617硬件部";
        xinm[41] = "迟卫新13661285623技术支持部";
        xinm[42] = "王意13810963381技术支持部";
        xinm[43] = "高琦13488834664技术支持部";
        xinm[44] = "郑云畅18210195501技术支持部";
        xinm[45] = "田乐13693580862技术支持部";
        xinm[46] = "范兰英15164800165技术支持部";
        xinm[47] = "籍磊15810395781技术支持部";
        xinm[48] = "张晓梅13041099455技术支持部";
        xinm[49] = "李明刚13311298286产品研发部";
        xinm[50] = "李召慧18439800409产品研发部";
        xinm[51] = "武亮15910309851产品研发部";
        xinm[52] = "张锴18611517372产品研发部";
        xinm[53] = "靳利强18722457930产品研发部";
        xinm[54] = "王春玺15522571815产品研发部";
        xinm[55] = "秦领15810430872产品研发部";
        xinm[56] = "翟康宁18500359581产品研发部";
        xinm[57] = "朱育刚17310080730产品研发部";
        xinm[58] = "黄文奎15600800591产品研发部";
        xinm[59] = "魏绍玺13552190221产品研发部";
        xinm[60] = "赵娜18518257268产品研发部";
        xinm[61] = "李岩18633265431产品研发部";
        xinm[62] = "陈玲玲18518677753产品研发部";
        xinm[63] = "王小雨13581863287销售部";
        xinm[64] = "肖传宏15215314141销售部";
        xinm[65] = "郑福顺13942651002销售部";
        xinm[66] = "王博15102201055销售部";
        xinm[67] = "杨淼森13572588425销售部";
        xinm[68] = "冯宣军18628261707销售部";
        xinm[69] = "吴柯森13546728753销售部";
        xinm[70] = "易冬15962340177销售部";
        xinm[71] = "李连省13405758396销售部";
        xinm[72] = "汤周易18602769670销售部";
        xinm[73] = "谢锡秋13828418950销售部";
        xinm[74] = "陈云捷18925013883销售部";
        xinm[75] = "翁铭图13794608339销售部";
        xinm[76] = "翁庸韩13556444944销售部";
        xinm[77] = "聂剑辉18618413230销售部";
        xinm[78] = "杨文雪13683595653销售部";
        xinm[79] = "徐璐璐13641111163销售部";
        xinm[80] = "董正红13356681936销售部";
        xinm[81] = "李金霞13173281588销售部";
        xinm[82] = "庄绪榕18806321128销售部";
        xinm[83] = "牛国华13731124055销售部";
        xinm[84] = "牛晓娜15981889301销售部";
        xinm[85] = "董霞15008497475销售部";
        xinm[86] = "钟双18623396688销售部";
        xinm[87] = "方伟娟13771931814销售部";
        xinm[88] = "邓宁凤13357826619销售部";
        xinm[89] = "李华梅18505291727销售部";
        xinm[90] = "孔利群13588863117销售部";
        xinm[91] = "李瑞霞15359899733销售部";
        xinm[92] = "周果13787240727销售部";
        xinm[93] = "许晓静13817917445销售部";
        xinm[94] = "曹美红15915701327销售部";
        xinm[95] = "侯铭15989378271销售部";
        xinm[96] = "韦东云13597395002销售部";
        xinm[97] = "袁海英13681152968销售部";
        xinm[98] = "徐真13241766583销售部";
        xinm[99] = "王晓慧18518296001销售部";
        xinm[100] = "刘呈波13701083857销售部";
        xinm[101] = "齐芳13693247078客服部";
        xinm[102] = "张玲玲18101050618客服部";
        xinm[103] = "于美玲17701359997客服部";
        xinm[104] = "魏媛媛18618257758客服部";
        xinm[105] = "李月13522513930客服部";
        xinm[106] = "马丽华13241735257客服部";
        xinm[107] = "李盛桐18701180498客服部";
        xinm[108] = "王玲13801358815客服部";
        xinm[109] = "梅凤君15101664633客服部";
        xinm[110] = "段娜娜18210238194客服部";
        xinm[111] = "冯雪莲13681039885客服部";
        xinm[112] = "王然18210257731客服部";
        xinm[113] = "武文莉18911731302客服部";
        xinm[114] = "严胜芳13701139881客服部";
        xinm[115] = "高莆13391858909客服部";
        xinm[116] = "邱爽18301658611客服部";
        xinm[117] = "史晓宇13172127001客服部";
        xinm[118] = "陶立新13552317557客服部";
        xinm[119] = "崔维芳15510684518客服部";
        xinm[120] = "王玉梅13641359830客服部";
        xinm[121] = "曹丽娜18511266246客服部";
        xinm[122] = "王志萍13269563266客服部";
        xinm[123] = "任健13716323667中钰";
        xinm[124] = "周慧君15010063688益基";
        xinm[125] = "黄齐18007177697益基";
        xinm[126] = "江秀坤13608082258安蒂康";

        var notTdj=['郑敏15810721236财务部','赵迪娜13910693260人力资源行政部', '张二苗13691514053人力资源行政部', '徐敏17710637758运营部', '伍廷超18910659337运营部', '李瑛18911773480运营部', '张晓梅13041099455技术支持部', '赵娜18518257268产品研发部', '陈玲玲18518677753产品研发部','钟双18623396688销售部', '王然18210257731客服部'];
        var tdj=new Array();//特等奖名单
        var ydj=new Array();//一等奖名单
        var edj=new Array();//二等奖名单
        var sdj=new Array();//三等奖名单
        var nametxt = $('#name');
        var pcount = xinm.length-1;//参加人数
        var runing = true;
        var num = 0;
        var t;
        var m;
//开始停止
        $('#btntdj').click(function () {
            if(tdj.length==1){
                layer.alert("特等奖抽完啦");
                return false;
            }
            if (runing) {
                runing = false;
                $(this).removeClass('btn-primary').addClass('btn-danger');
                $(this).html('停止');
                startNumT();
            } else {
                runing = true;
                $(this).removeClass('btn-danger').addClass('btn-primary');
                $(this).html('特等奖');
                stopT();
                save("t");
            }
        });
        $('#btnydj').click(function () {
            if(ydj.length==3){
                layer.alert("一等奖抽完啦");
                return false;
            }
            if (runing) {
                runing = false;
                $(this).removeClass('btn-primary').addClass('btn-danger');
                $(this).html('停止');
                startNum();
            } else {
                runing = true;
                $(this).removeClass('btn-danger').addClass('btn-primary');
                $(this).html('一等奖');
                stop();
                save("y");
            }
        });
        $('#btnedj').click(function () {
            if(edj.length==5){
                layer.alert("二等奖抽完啦");
                return false;
            }
            if (runing) {
                runing = false;
                $(this).removeClass('btn-primary').addClass('btn-danger');
                $(this).html('停止');
                startNum();
            } else {
                runing = true;
                $(this).removeClass('btn-danger').addClass('btn-primary');
                $(this).html('二等奖');
                stop();
                save("e");
            }
        });
        $('#btnsdj').click(function () {
            if(sdj.length==8){
                layer.alert("三等奖抽完啦");
                return false;
            }
            if (runing) {
                runing = false;
                $(this).removeClass('btn-primary').addClass('btn-danger');
                $(this).html('停止');
                startNum();
            } else {
                runing = true;
                $(this).removeClass('btn-danger').addClass('btn-primary');
                $(this).html('三等奖');
                stop();
                save("s");
            }
        });
//注：标红字人员代表不能参与抽特等奖人员
        Array.prototype.in_array = function(e)
        {
            for(i=0;i<this.length;i++)
            {
                if(this[i] == e)
                    return true;
            }
            return false;
        };
        function startNumT() {
            mp3.play();
            num =randomNum();
            nametxt.html(xinm[num]);
            m=setTimeout(startNumT,0);
        }
        function randomNum() {
           var k = Math.floor(Math.random() * pcount);
            if(notTdj.in_array(xinm[k])){
                randomNum();
            }else {

                return k;
            }

        }
        function stopT() {
            mp3.pause();
            pcount = xinm.length-1;
            clearInterval(m);
        }
//循环参加名单
        function startNum() {
            mp3.play();
            num = Math.floor(Math.random() * pcount);
            nametxt.html(xinm[num]);
            t = setTimeout(startNum, 0);
        }
//停止跳动
        function stop() {
            mp3.pause();
            pcount = xinm.length-1;
            clearInterval(t);
            t = 0;
        }
        function save(level) {
            if(level=='t'){
                var removeItem =xinm[num];
                tdj.push(removeItem);
                xinm = $.grep(xinm, function(value) {
                    return value != removeItem;
                });
                localStorage.setItem("tdj",tdj);
            }
            if(level=='y'){
                var removeItem =xinm[num];
                ydj.push(removeItem);
                xinm = $.grep(xinm, function(value) {
                    return value != removeItem;
                });
                localStorage.setItem("ydj",ydj);
            }
            if(level=='e'){
                var removeItem =xinm[num];
                edj.push(removeItem);
                xinm = $.grep(xinm, function(value) {
                    return value != removeItem;
                });
                localStorage.setItem("edj",edj);
            }
            if(level=='s'){
                var removeItem =xinm[num];
                sdj.push(removeItem);
                xinm = $.grep(xinm, function(value) {
                    return value != removeItem;
                });
                localStorage.setItem("sdj",sdj);
            }
        }
        function createHtml(array) {
            if(array==""||array==null){
                return "";
            }
            var items =array.split(",");
            var div='';
            for (i=0;i<items.length;i++){
                div+="<div class='col-sm-6'><p>"+items[i]+"</p></div>";
            }
            return div;
        }
        $("#showList").click(function () {
                    $("#divtdj").html(createHtml(localStorage.getItem("tdj")));
                    $("#divydj").html(createHtml(localStorage.getItem("ydj")));
                    $("#divedj").html(createHtml(localStorage.getItem("edj")));
                    $("#divsdj").html(createHtml(localStorage.getItem("sdj")));
            $("#modal").modal('toggle');
                });
        $("#clearLocal").click(function () {
            localStorage.clear();
            layer.alert("数据已清空");
            window.location.reload();
            $("#modal").modal('toggle');
        });
    });
</script>
</html>